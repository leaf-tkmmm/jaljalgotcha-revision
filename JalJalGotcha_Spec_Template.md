# 📜 JalJalGotcha 仕様書テンプレート（Claude用）

## 1. プロジェクト概要

* **アプリ名**: JalJalGotcha
* **目的**: 指定した分数以内で収まる「ジャルジャル動画の組み合わせ」を自動生成し、Web上で表示する。

---

## 2. 使用技術スタック（予定）

* **フロントエンド**: Next.js
* **バックエンド**: Next.js
* **デプロイ先**: Vercel

---

## 3. データ仕様

* **データ形式**: JSON
* **格置場所**: サーバー内に静的ファイル
* **動画情報の構造（例）**:

```json
{
  "id": "video_001",
  "title": "ネタタイトル",
  "duration": 185,
  "url": "https://youtube.com/xxx",
  "thumbnail": "https://img.youtube.com/xxx.jpg",
  "channel_id": "UChwgNUWPM-ksOP3BbfQHS5Q"
}
```

* **備考**: duration は秒単位。動画データはあらかじめ `duration` 昇順でソートされた状態で `videos.json` に保存されるため、アプリ側でのソート処理は不要。

---

## 4. ユーザー操作の流れ

1. 時間を分単位で入力（1〜1000）
2. 「ガチャ」ボタンを押す
3. 条件に合う動画の組み合わせが表示される
4. 結果の動画リストから各動画をクリック → YouTubeに遷移

---

## 5. 機能要件

### ✅ 入力

* 数値のみ（バリデーションあり）
* 入力範囲: `1 ≤ X ≤ 1000`
* バリデーション失敗時: エラーメッセージ表示

### ✅ 出力

* 合計時間が上限を超えない組み合わせ
* 表示要素:

  * タイトル
  * 所要時間（分: 秒）
  * サムネイル画像
  * YouTubeリンク
* \[任意] 総所要時間 or 残り時間の表示

---

## 6. アルゴリズム仕様

動画データをクライアント側で効率的に扱うために、以下の手順で最適化された組み合わせ生成アルゴリズムを採用します。

### 💡 処理手順

1. アプリ起動時に `videos.json` を一括読み込みし、JSONをパースする。
2. 読み込んだ動画データは `duration` 昇順にあらかじめソート済みであるため、そのまま配列としてメモリ上にキャッシュする。
3. ユーザーが希望時間を入力し、組み合わせ生成をリクエストした際に以下を実行する：

   a. 使用済み動画のIDを記録するための `Set` を用意する。
   b. ソート済み配列の先頭から順に走査し、現在の残り時間以下の動画だけを候補とする。
   c. その候補の中から、まだ使用されていない動画をランダムに1本選ぶ。
   d. 選ばれた動画を結果リストに追加し、残り時間からその動画の `duration` を減算する。
   e. 残り時間が 60 秒未満になるまで、b 〜 d を繰り返す。

---

## 7. UI要件

* レスポンシブデザイン
* スマホ対応（縦長でも閲覧快適に）